---
import Layout from '../../layouts/Layout.astro';
import serviceDetails from '../../data/serviceDetails.json';

export async function getStaticPaths() {
  return serviceDetails.map((service) => ({
    params: { slug: service.slug },
    props: { service },
  }));
}

const { service } = Astro.props;
const whatsappLink = `https://wa.me/919092303060?text=${encodeURIComponent(service.whatsappMsg)}`;

// Image Mapping (Same as Tours.astro)
const tourImages = {
  "tirupati-package": "/images/temple/Tirupati-Balaji.jpg",
  "thiruvannamalai-girivalam-trip": "/images/temple/Thiruvannamalai-Girivalam.jpg",
  "rameswaram-2-days": "/images/temple/Rameswaram.avif",
  "navagraha-tour": "/images/temple/Navagraha.jpg",
  "kanchipuram-temple-trip": "/images/temple/Kanchipuram-Temple.jpg",
  "chidambaram-temple-trip": "/images/temple/Chidambaram-Natarajar-Temple.jpg",
  "sabarimala-trip": "/images/temple/Sabarimala-Temple.jpg",
  "pondicherry-one-day-trip": "https://images.pexels.com/photos/32009229/pexels-photo-32009229.jpeg?auto=compress&cs=tinysrgb&w=800",
  "vellore-golden-temple": "/images/temple/Vellore-Golden.jpg",
  "mahabalipuram-ecr-temple-route": "/images/temple/Mahabalipuram-ECR-Temples.jpg",
  "one-day-chennai-city-tour": "/images/temple/chennai-city.jpg" 
};

const heroImage = tourImages[service.slug];
---

<Layout title={`${service.title} - Kalidass Travels`}>
  <main class="bg-gray-50 min-h-screen pb-20">
    <!-- Hero Header -->
    <div class="bg-black text-white pt-32 pb-16 px-6 relative overflow-hidden">
      
      {/* Background Image Layer */}
      {heroImage && (
        <div class="absolute inset-0 z-0">
          <img 
            src={heroImage} 
            alt={service.title} 
            class="w-full h-full object-cover opacity-60"
          />
        </div>
      )}

      {/* Gradient Overlay (Darker if image exists to ensure readability) */}
      <div class={`absolute inset-0 z-0 ${heroImage ? 'bg-gradient-to-t from-black via-black/80 to-transparent' : 'bg-gradient-to-br from-red-900/40 to-black'}`}></div>

      <div class="max-w-4xl mx-auto relative z-10">
        <span class="inline-block py-1 px-3 rounded-full bg-red-600/20 border border-red-500/30 text-red-400 text-xs font-semibold tracking-wider mb-4 uppercase">
          {service.category}
        </span>
        <h1 class="text-3xl md:text-5xl font-bold mb-4 leading-tight">{service.title}</h1>
        {service.overview && <p class="text-gray-300 text-lg max-w-2xl">{service.overview}</p>}
      </div>
    </div>

    <div class="max-w-4xl mx-auto px-6 -mt-8 relative z-20">
      <div class="bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden">
        
        <!-- Tariff Section -->
        {service.tariff && (
          <div class="p-6 md:p-8 border-b border-gray-100">
            <h2 class="text-xl font-bold text-gray-900 mb-6 flex items-center gap-2">
              <i class="fa-solid fa-tag text-red-600"></i> Tariff & Pricing
            </h2>
            
            <div class="overflow-x-auto">
              <table class="w-full text-left border-collapse">
                <thead>
                  <tr class="bg-gray-50 border-b border-gray-200">
                    {service.tariff.headers.map((header) => (
                      <th class="py-3 px-4 text-sm font-semibold text-gray-700 uppercase tracking-wider">{header}</th>
                    ))}
                  </tr>
                </thead>
                <tbody class="divide-y divide-gray-100">
                  {service.tariff.rows.map((row) => (
                    <tr class="hover:bg-gray-50 transition-colors">
                      {row.map((cell) => (
                        <td class="py-3 px-4 text-gray-800 font-medium">{cell}</td>
                      ))}
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
            {service.tariff.note && (
              <p class="mt-4 text-sm text-gray-500 italic bg-yellow-50 p-3 rounded border border-yellow-100">
                <i class="fa-solid fa-circle-info mr-2 text-yellow-600"></i> {service.tariff.note}
              </p>
            )}
          </div>
        )}

        <!-- Details Grid -->
        <div class="grid md:grid-cols-2 gap-0 divide-y md:divide-y-0 md:divide-x divide-gray-100">
          
          <!-- Includes -->
          {service.includes && (
            <div class="p-6 md:p-8">
              <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-check-circle text-green-600"></i> What's Included
              </h3>
              <ul class="space-y-3">
                {service.includes.map((item) => (
                  <li class="flex items-start gap-3 text-gray-600 text-sm">
                    <span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-green-500 shrink-0"></span>
                    {item}
                  </li>
                ))}
              </ul>
            </div>
          )}

          <!-- Excludes -->
          {service.excludes && (
            <div class="p-6 md:p-8 bg-gray-50/50">
              <h3 class="text-lg font-bold text-gray-900 mb-4 flex items-center gap-2">
                <i class="fa-solid fa-times-circle text-red-500"></i> Not Included
              </h3>
              <ul class="space-y-3">
                {service.excludes.map((item) => (
                  <li class="flex items-start gap-3 text-gray-500 text-sm">
                    <span class="mt-1.5 w-1.5 h-1.5 rounded-full bg-red-300 shrink-0"></span>
                    {item}
                  </li>
                ))}
              </ul>
            </div>
          )}
        </div>

        <!-- FAQ Section -->
        {service.faq && (
          <div class="p-6 md:p-8 border-t border-gray-100">
            <h3 class="text-lg font-bold text-gray-900 mb-6">Frequently Asked Questions</h3>
            <div class="grid gap-4">
              {service.faq.map((item) => (
                <div class="bg-gray-50 rounded-lg p-4 border border-gray-100">
                  <p class="font-semibold text-gray-900 text-sm mb-2 flex items-start gap-2">
                    <span class="text-red-600">Q:</span> {item.q}
                  </p>
                  <p class="text-gray-600 text-sm pl-6 border-l-2 border-gray-200">
                    {item.a}
                  </p>
                </div>
              ))}
            </div>
          </div>
        )}

        <!-- Notes -->
        {service.notes && (
          <div class="p-6 md:p-8 bg-blue-50 border-t border-blue-100">
            <h4 class="text-sm font-bold text-blue-900 uppercase tracking-wide mb-3">Important Notes</h4>
            <ul class="space-y-2">
              {service.notes.map((note) => (
                <li class="text-blue-800 text-sm flex items-start gap-2">
                  <i class="fa-solid fa-info-circle mt-1 opacity-70"></i> {note}
                </li>
              ))}
            </ul>
          </div>
        )}

        <!-- Sticky Mobile CTA / Desktop Footer CTA -->
        <div class="p-6 bg-gray-900 text-white flex flex-col md:flex-row items-center justify-between gap-4 sticky bottom-0 md:relative z-30">
          <div>
            <p class="text-gray-400 text-xs uppercase tracking-wider mb-1">Ready to book?</p>
            <p class="font-bold text-lg">Instant Confirmation via WhatsApp</p>
          </div>
          <a 
            href={whatsappLink}
            target="_blank"
            class="w-full md:w-auto bg-green-600 hover:bg-green-500 text-white font-bold py-3 px-8 rounded-lg transition-all flex items-center justify-center gap-2 shadow-lg shadow-green-900/20"
          >
            <i class="fa-brands fa-whatsapp text-xl"></i>
            Book Now
          </a>
        </div>

      </div>
    </div>
  </main>
</Layout>
